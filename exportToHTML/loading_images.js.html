<html>
<head>
  <title>service.js</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <style type="text/css">
    html {
      font-size: 20px;
    }

    .ln {
      color: rgb(255, 255, 255);
      font-weight: normal;
      font-style: normal;
    }

    .s0 {
      color: rgb(67, 115, 57);
      font-weight: bold;
      font-style: italic;
    }

    .s1 {
      color: rgb(82, 109, 74);
      font-weight: bold;
      font-style: italic;
    }

    .s2 {
      color: rgb(127, 139, 154);
    }

    .s3 {
      color: rgb(165, 194, 92);
    }

    .s4 {
      color: rgb(204, 120, 50);
    }

    .s5 {
      color: rgb(204, 120, 50);
      font-weight: bold;
    }

    .s6 {
      color: rgb(128, 128, 128);
    }

    .s7 {
      color: rgb(104, 151, 187);
    }
  </style>
</head>
<BODY BGCOLOR="#111111">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#C0C0C0">
  <TR>
    <TD>
      <CENTER>
        <FONT FACE="Arial, Helvetica" COLOR="#000000">
          Loading assets</FONT>
      </center>
    </TD>
  </TR>
</TABLE>
<pre>

<a name="l105"><span class="ln">105  </span></a>
<a name="l106"><span class="ln">106  </span></a>      </span><span class="s0">/**
<a name="l107"><span class="ln">107  </span></a>       * fetch image asset
<a name="l108"><span class="ln">108  </span></a>       * </span><span class="s1">@param </span><span class="s0">url - asset url
<a name="l109"><span class="ln">109  </span></a>       * </span><span class="s1">@param </span><span class="s0">node - book object node to update
<a name="l110"><span class="ln">110  </span></a>       * </span><span class="s1">@returns </span><span class="s0">{*}
<a name="l111"><span class="ln">111  </span></a>       */</span><span class="s2">
<a name="l112"><span class="ln">112  </span></a>      </span><span class="s5">this</span><span class="s2">.fetchImageAsset = </span><span
  class="s5">function</span><span class="s2">(url</span><span class="s4">, </span><span class="s2">node) {
<a name="l113"><span class="ln">113  </span></a>        </span><span class="s5">var </span><span class="s2">deferred = $q.defer()
<a name="l114"><span class="ln">114  </span></a>          </span><span class="s4">, </span><span
  class="s2">loader</span><span class="s4">;</span><span class="s2">
<a name="l115"><span class="ln">115  </span></a>        loader = </span><span class="s5">new </span><span class="s2">PIXI.ImageLoader(url)</span><span
  class="s4">;</span><span class="s2">
<a name="l116"><span class="ln">116  </span></a>        loader.onLoaded = </span><span class="s5">function</span><span
  class="s2">() {
<a name="l117"><span class="ln">117  </span></a>          </span><span class="s5">var </span><span class="s2">texture = PIXI.TextureCache[url]</span><span
  class="s4">;</span><span class="s2">
<a name="l118"><span class="ln">118  </span></a>          node.sprite = </span><span class="s5">new </span><span
  class="s2">PIXI.Sprite(texture)</span><span class="s4">;</span><span class="s2">
<a name="l119"><span class="ln">119  </span></a>          node.sprite.anchor.x = </span><span class="s7">0</span><span
  class="s4">;</span><span class="s2">
<a name="l120"><span class="ln">120  </span></a>          node.sprite.anchor.y = </span><span class="s7">0</span><span
  class="s4">;</span><span class="s2">
<a name="l121"><span class="ln">121  </span></a>          node.sprite.position.x = -</span><span
  class="s7">21</span><span class="s4">;</span><span class="s2">
<a name="l122"><span class="ln">122  </span></a>          node.sprite.position.y = -</span><span
  class="s7">21</span><span class="s4">;</span><span class="s2">
<a name="l123"><span class="ln">123  </span></a>          node.sprite.node = node</span><span class="s4">;</span><span
  class="s2">
<a name="l124"><span class="ln">124  </span></a>          </span><span class="s5">if </span><span class="s2">(node.properties.styles) {
<a name="l125"><span class="ln">125  </span></a>            node.sprite.position.x = Math.ceil(node.properties.styles.left)</span><span
  class="s4">;</span><span class="s2">
<a name="l126"><span class="ln">126  </span></a>            node.sprite.position.y = Math.ceil(node.properties.styles.top)</span><span
  class="s4">;</span><span class="s2">
<a name="l127"><span class="ln">127  </span></a>          }
<a name="l128"><span class="ln">128  </span></a>          deferred.resolve(node)</span><span class="s4">;</span><span
  class="s2">
<a name="l129"><span class="ln">129  </span></a>        }</span><span class="s4">;</span><span class="s2">
<a name="l130"><span class="ln">130  </span></a>        loader.load()</span><span class="s4">;</span><span class="s2">
<a name="l131"><span class="ln">131  </span></a>        </span><span class="s5">return </span><span class="s2">deferred.promise</span><span
  class="s4">;</span><span class="s2">
<a name="l132"><span class="ln">132  </span></a>      }</span><span class="s4">;</span><span class="s2">
<a name="l133"><span class="ln">133  </span></a>
</span></pre>
</body>
</html>